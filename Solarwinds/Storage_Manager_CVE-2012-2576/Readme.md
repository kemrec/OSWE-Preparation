# SolarWinds Storage Manager 5.1.0 - Remote SYSTEM SQL Injection

## CVE-2012-2576

SQL injection vulnerability in the LoginServlet page in SolarWinds Storage Manager before 5.1.2, SolarWinds Storage Profiler before 5.1.2, and SolarWinds Backup Profiler before 5.1.2 allows remote attackers to execute arbitrary SQL commands via the loginName field.

## Discovery Process:

Storage Manager login screen, send username single qoute(') and any character to password.

![ss1](https://github.com/kemrec/OSWE-Preparation/blob/master/Solarwinds/Storage_Manager_CVE-2012-2576/ss/storagemanager1.GIF "ss1")

Application return to us with SQL error :)

![ss2](https://github.com/kemrec/OSWE-Preparation/blob/master/Solarwinds/Storage_Manager_CVE-2012-2576/ss/storagemanager2.GIF "ss2")

As we can see above screenshot, backend SQL sentences `SELECT * FROM user WHERE LoginName='' AND Password='' AND Login=1` and user inputs goes to SQL sentences without any sanitations.

To bypass login, send `'+or+1=1--+` payload with username, our backend SQL runs with like that `SELECT * FROM user WHERE LoginName='' OR 1=1--+' AND Password='' AND Login=1` and LoginName parameter returns True and login successfully,

![ss3](https://github.com/kemrec/OSWE-Preparation/blob/master/Solarwinds/Storage_Manager_CVE-2012-2576/ss/storagemanager3.GIF "ss3")

When we collect all this information, we can upload the reverse-shell into the application with the help of SQL injection. Our PoC attached solarshell.py and ss in below.

### PoC: 

Used SQL "INTO OUTFILE" capabilities and uploaded reverse-shell JSP page to vulnerable web site.

![exploit-screen](https://github.com/kemrec/OSWE-Preparation/blob/master/Solarwinds/Storage_Manager_CVE-2012-2576/ss.PNG "exploit")

